(()=>{var r={773:()=>{var r;WebGLUtils={create3DContext:r=function(r,t){for(var e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=null,o=0;o<e.length;++o){try{i=r.getContext(e[o],t)}catch(r){}if(i)break}return i},setupWebGL:function(t,e,i){i=i||function(r){var e=t.parentNode;if(e){var i=window.WebGLRenderingContext?'It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>':'This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>';r&&(i+="<br/><br/>Status: "+r),e.innerHTML=function(r){return'<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+r+"</div></div></td></tr></table>"}(i)}},t.addEventListener&&t.addEventListener("webglcontextcreationerror",(function(r){i(r.statusMessage)}),!1);var o=r(t,e);return o||window.WebGLRenderingContext||i(""),o}},window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(r,t){window.setTimeout(r,1e3/60)}},619:(r,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>i});const i="#extension GL_OES_standard_derivatives : enable\r\nprecision mediump float;\r\n\r\n// varying vec4 fragcolor;\r\nvarying vec3 pos;\r\n\r\nvoid main(void) {\r\n    // Normal\r\n\r\n    vec3 dx = dFdx(pos);\r\n    vec3 dy = dFdy(pos);\r\n    vec3 normal = normalize(cross(dx, dy));\r\n\r\n    // Color\r\n    vec3 viewDir = normalize(vec3(0, 0, 50));\r\n    vec3 lightPos = vec3(50, 50, 20);\r\n    \r\n    vec3 dir = normalize(lightPos - pos);\r\n    vec3 lightCor = vec3(0.5, .5, .5);\r\n    float lightIntensity = 1.;\r\n    float dif = dot(normalize(normal), dir);\r\n\r\n    gl_FragColor = vec4(.5, .0, .0, 1);\r\n    gl_FragColor.rgb += lightCor * dif * lightIntensity;\r\n    vec3 halfDir = normalize(viewDir + dir);\r\n    float _spec = 1.;\r\n    float _gloss = 10.;\r\n    float spec = _spec * pow(clamp(dot(normal, halfDir), 0., 1.),  _gloss);\r\n    spec = step(0.7, spec);\r\n    gl_FragColor.rgb += lightCor*spec;\r\n}"},990:(r,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>i});const i="attribute vec3 aVertexPosition;\r\n// attribute vec3 aFrontColor;\r\n// attribute vec3 aNormal;\r\n\r\nuniform mat4 uModelMatrix;\r\nuniform mat4 uMVMatrix;\r\nuniform mat4 uPMatrix;\r\n\r\nvarying vec3 pos;\r\n\r\nvoid shading() {\r\n}\r\n\r\nvoid main(void) {\r\n    pos = (uMVMatrix * vec4(aVertexPosition, 1.0)).xyz;\r\n    gl_Position = uPMatrix * uMVMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\r\n}"},44:(r,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>i});const i="precision mediump float;\r\n\r\nvarying vec4 fragcolor;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = fragcolor;\r\n}"},49:(r,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>i});const i="attribute vec3 aVertexPosition;\r\nattribute vec3 aFrontColor;\r\nattribute vec3 aNormal;\r\n\r\nuniform mat4 uModelMatrix;\r\nuniform mat4 uMVMatrix;\r\nuniform mat4 uPMatrix;\r\nuniform mat4 uinvTMVMatrix;\r\nuniform mat4 uinvTModelMatrix;\r\n\r\nvarying vec4 fragcolor;\r\nvarying vec3 normal;\r\nvarying vec3 pos;\r\n\r\nvoid shading() {\r\n    vec3 viewDir = normalize(vec3(0, 0, 50));\r\n    vec3 lightPos = vec3(50, 50, 20);\r\n    \r\n    vec3 dir = normalize(lightPos - pos);\r\n    vec3 lightCor = vec3(0.5, .5, .5);\r\n    float lightIntensity = 1.;\r\n    float dif = dot(normalize(normal), dir);\r\n\r\n    fragcolor = vec4(.5, .0, .0, 1);\r\n    fragcolor.rgb += lightCor * dif * lightIntensity;\r\n    vec3 halfDir = normalize(viewDir + dir);\r\n    float _spec = 1.;\r\n    float _gloss = 10.;\r\n    float spec = _spec * pow(clamp(dot(normal, halfDir), 0., 1.),  _gloss);\r\n    spec = step(0.7, spec);\r\n    fragcolor.rgb += lightCor*spec;\r\n}\r\n\r\nvoid main(void) {\r\n    pos = (uMVMatrix * vec4(aVertexPosition, 1.0)).xyz;\r\n    gl_Position = uPMatrix * uMVMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\r\n    normal = normalize((uinvTMVMatrix * uinvTModelMatrix * vec4(aNormal, 0.0)).xyz);\r\n    shading();\r\n}"},935:(r,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>i});const i="precision mediump float;\r\n\r\nvarying vec4 fragcolor;\r\nvarying vec3 normal;\r\nvarying vec3 pos;\r\n\r\nvoid main(void) {\r\n    vec3 viewDir = normalize(vec3(0, 0, 50));\r\n\r\n    // if(abs(dot(viewDir, normal)) < 0.45){\r\n    //     gl_FragColor = vec4(0, 0, 0, 1);\r\n    //     return;\r\n    // }\r\n\r\n    vec3 lightPos = vec3(50, 50, 20);\r\n    vec3 dir = normalize(lightPos - pos);\r\n    vec3 lightCor = vec3(0.5, .5, .5);\r\n    float lightIntensity = 1.;\r\n    //dir = normalize(vec3(0, 1, 1));\r\n\r\n\r\n    float dif = dot(normalize(normal), dir);\r\n    // if(dif > .6) dif = 0.8;\r\n    // else if(dif > .25) dif = .3;\r\n    \r\n\r\n    gl_FragColor = vec4(.5, .0, .0, 1);\r\n    // gl_FragColor.rgb *= 0.4;\r\n    gl_FragColor.rgb += lightCor * dif * lightIntensity;\r\n    vec3 halfDir = normalize(viewDir + dir);\r\n    float _spec = 1.;\r\n    float _gloss = 10.;\r\n    float spec = _spec * pow(clamp(dot(normal, halfDir), 0., 1.),  _gloss);\r\n    // spec = step(0.7, spec);\r\n    gl_FragColor.rgb += lightCor*spec;\r\n}"},860:(r,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>i});const i="attribute vec3 aVertexPosition;\r\nattribute vec3 aFrontColor;\r\nattribute vec3 aNormal;\r\n\r\nuniform mat4 uModelMatrix;\r\nuniform mat4 uMVMatrix;\r\nuniform mat4 uPMatrix;\r\nuniform mat4 uinvTMVMatrix;\r\nuniform mat4 uinvTModelMatrix;\r\n\r\nvarying vec4 fragcolor;\r\nvarying vec3 normal;\r\nvarying vec3 pos;\r\n\r\nvoid main(void) {\r\n    fragcolor = vec4(aFrontColor.rgb, 1.0);\r\n    pos = (uMVMatrix * vec4(aVertexPosition, 1.0)).xyz;\r\n    gl_Position = uPMatrix * uMVMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\r\n    normal = normalize((uinvTMVMatrix * uinvTModelMatrix * vec4(aNormal, 0.0)).xyz);\r\n}"},312:(r,t,e)=>{var i={"./flat.frag":619,"./goraud.frag":44,"./v.frag":935};function o(r){var t=n(r);return e(t)}function n(r){if(!e.o(i,r)){var t=new Error("Cannot find module '"+r+"'");throw t.code="MODULE_NOT_FOUND",t}return i[r]}o.keys=function(){return Object.keys(i)},o.resolve=n,r.exports=o,o.id=312},915:(r,t,e)=>{var i={"./flat.vert":990,"./goraud.vert":49,"./v.vert":860};function o(r){var t=n(r);return e(t)}function n(r){if(!e.o(i,r)){var t=new Error("Cannot find module '"+r+"'");throw t.code="MODULE_NOT_FOUND",t}return i[r]}o.keys=function(){return Object.keys(i)},o.resolve=n,r.exports=o,o.id=915}},t={};function e(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return r[i](n,n.exports,e),n.exports}e.d=(r,t)=>{for(var i in t)e.o(t,i)&&!e.o(r,i)&&Object.defineProperty(r,i,{enumerable:!0,get:t[i]})},e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"==typeof window)return window}}(),e.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t),e.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},(()=>{"use strict";var r="undefined"!=typeof Float32Array?Float32Array:Array;function t(){var t=new r(3);return r!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function i(t,e,i){var o=new r(3);return o[0]=t,o[1]=e,o[2]=i,o}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});function o(){var t=new r(4);return r!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}t(),e(773),function(){var t;t=new r(4),r!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var n;function a(){var t=new r(16);return r!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function s(r,t){if(r===t){var e=t[1],i=t[2],o=t[3],n=t[6],a=t[7],s=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=e,r[6]=t[9],r[7]=t[13],r[8]=i,r[9]=n,r[11]=t[14],r[12]=o,r[13]=a,r[14]=s}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r}function l(r,t){var e=t[0],i=t[1],o=t[2],n=t[3],a=t[4],s=t[5],l=t[6],g=t[7],h=t[8],v=t[9],u=t[10],d=t[11],c=t[12],f=t[13],m=t[14],x=t[15],M=e*s-i*a,p=e*l-o*a,b=e*g-n*a,w=i*l-o*s,P=i*g-n*s,y=o*g-n*l,A=h*f-v*c,_=h*m-u*c,F=h*x-d*c,T=v*m-u*f,C=v*x-d*f,S=u*x-d*m,L=M*S-p*C+b*T+w*F-P*_+y*A;return L?(L=1/L,r[0]=(s*S-l*C+g*T)*L,r[1]=(o*C-i*S-n*T)*L,r[2]=(f*y-m*P+x*w)*L,r[3]=(u*P-v*y-d*w)*L,r[4]=(l*F-a*S-g*_)*L,r[5]=(e*S-o*F+n*_)*L,r[6]=(m*b-c*y-x*p)*L,r[7]=(h*y-u*b+d*p)*L,r[8]=(a*C-s*F+g*A)*L,r[9]=(i*F-e*C-n*A)*L,r[10]=(c*P-f*b+x*M)*L,r[11]=(v*b-h*P-d*M)*L,r[12]=(s*_-a*T-l*A)*L,r[13]=(e*T-i*_+o*A)*L,r[14]=(f*p-c*w-m*M)*L,r[15]=(h*w-v*p+u*M)*L,r):null}function g(r,t){var e=t[0],i=t[1],o=t[2],n=t[3],a=e+e,s=i+i,l=o+o,g=e*a,h=i*a,v=i*s,u=o*a,d=o*s,c=o*l,f=n*a,m=n*s,x=n*l;return r[0]=1-v-c,r[1]=h+x,r[2]=u-m,r[3]=0,r[4]=h-x,r[5]=1-g-c,r[6]=d+f,r[7]=0,r[8]=u+m,r[9]=d-f,r[10]=1-g-v,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}t(),i(1,0,0),i(0,1,0),o(),o(),n=new r(9),r!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1;var h=function(r,t,e){var i=t[0],o=t[1],n=t[2],a=t[3],s=t[4],l=t[5],g=t[6],h=t[7],v=t[8],u=t[9],d=t[10],c=t[11],f=t[12],m=t[13],x=t[14],M=t[15],p=e[0],b=e[1],w=e[2],P=e[3];return r[0]=p*i+b*s+w*v+P*f,r[1]=p*o+b*l+w*u+P*m,r[2]=p*n+b*g+w*d+P*x,r[3]=p*a+b*h+w*c+P*M,p=e[4],b=e[5],w=e[6],P=e[7],r[4]=p*i+b*s+w*v+P*f,r[5]=p*o+b*l+w*u+P*m,r[6]=p*n+b*g+w*d+P*x,r[7]=p*a+b*h+w*c+P*M,p=e[8],b=e[9],w=e[10],P=e[11],r[8]=p*i+b*s+w*v+P*f,r[9]=p*o+b*l+w*u+P*m,r[10]=p*n+b*g+w*d+P*x,r[11]=p*a+b*h+w*c+P*M,p=e[12],b=e[13],w=e[14],P=e[15],r[12]=p*i+b*s+w*v+P*f,r[13]=p*o+b*l+w*u+P*m,r[14]=p*n+b*g+w*d+P*x,r[15]=p*a+b*h+w*c+P*M,r};WebGLBuffer;class v{constructor(r,e){this.position=function(r){return r[0]=0,r[1]=0,r[2]=0,r}(t()),this.rotation=o(),this.scale=i(1,1,1),this.isLoaded=!1,this.shaderProgram=r,void 0!==e&&this.loadModel(e)}loadModel(r){var t=new XMLHttpRequest;t.open("GET",`./model/${r}.json`),t.onreadystatechange=()=>{4==t.readyState&&(this.vertexAttributes=JSON.parse(t.responseText),console.log(this.vertexAttributes),this.handleModelData())},t.send()}handleModelData(){this.vertexBuffers={};for(let t in this.vertexAttributes)if(void 0!==t&&"vertexTextureCoords"!==t){var r=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,r),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(this.vertexAttributes[t]),gl.STATIC_DRAW),r.itemSize=3,r.numItems=this.vertexAttributes[t].length/3,console.log(r),this.vertexBuffers[t]=r}this.isLoaded=!0}draw(){this.isLoaded&&(gl.useProgram(this.shaderProgram.shaderProgram),this.setUniform(),gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffers.vertexPositions),gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,this.vertexBuffers.vertexPositions.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffers.vertexFrontcolors),gl.vertexAttribPointer(this.shaderProgram.vertexFrontColorAttribute,this.vertexBuffers.vertexFrontcolors.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffers.vertexNormals),gl.vertexAttribPointer(this.shaderProgram.vertexNormalAttribute,this.vertexBuffers.vertexNormals.itemSize,gl.FLOAT,!1,0,0),gl.drawArrays(gl.TRIANGLES,0,this.vertexBuffers.vertexPositions.numItems))}setUniform(){let r=a();h(r,g(a(),this.rotation),function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}(a(),this.scale)),h(r,function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}(a(),this.position),r),gl.uniformMatrix4fv(this.shaderProgram.modelMatrixUniform,!1,r),s(r,l(r,r)),gl.uniformMatrix4fv(this.shaderProgram.invT_modelMatrixUniform,!1,r)}setScale(r){return function(r,t,e){r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e}(this.scale,this.scale,r),this}setScaleXYZ(r,t,e){return this.scale=i(r,t,e),this}setPos(r,t,e){return this.position=i(r,t,e),this}translate(r,t,e){return function(r,t,e){r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2]}(this.position,this.position,i(r,t,e)),this}setRot(r,t,e){return this.rotation=function(r,t,e,i){var o=.5*Math.PI/180;t*=o,e*=o,i*=o;var n=Math.sin(t),a=Math.cos(t),s=Math.sin(e),l=Math.cos(e),g=Math.sin(i),h=Math.cos(i);return r[0]=n*l*h-a*s*g,r[1]=a*s*h+n*l*g,r[2]=a*l*g-n*s*h,r[3]=a*l*h+n*s*g,r}(o(),r,t,e),this}rotateX(r){return function(r,t,e){e*=.5;var i=t[0],o=t[1],n=t[2],a=t[3],s=Math.sin(e),l=Math.cos(e);r[0]=i*l+a*s,r[1]=o*l+n*s,r[2]=n*l-o*s,r[3]=a*l-i*s}(this.rotation,this.rotation,r),this}rotateY(r){return function(r,t,e){e*=.5;var i=t[0],o=t[1],n=t[2],a=t[3],s=Math.sin(e),l=Math.cos(e);r[0]=i*l-n*s,r[1]=o*l+a*s,r[2]=n*l+i*s,r[3]=a*l-o*s}(this.rotation,this.rotation,r),this}rotateZ(r){return function(r,t,e){e*=.5;var i=t[0],o=t[1],n=t[2],a=t[3],s=Math.sin(e),l=Math.cos(e);r[0]=i*l+o*s,r[1]=o*l-i*s,r[2]=n*l+a*s,r[3]=a*l-n*s}(this.rotation,this.rotation,r),this}rotateAxis(r,t){return function(r,t,e){var i=t[0],o=t[1],n=t[2],a=t[3],s=e[0],l=e[1],g=e[2],h=e[3];r[0]=i*h+a*s+o*g-n*l,r[1]=o*h+a*l+n*s-i*g,r[2]=n*h+a*g+i*l-o*s,r[3]=a*h-i*s-o*l-n*g}(this.rotation,this.rotation,function(r,t,e){e*=.5;var i=Math.sin(e);return r[0]=i*t[0],r[1]=i*t[1],r[2]=i*t[2],r[3]=Math.cos(e),r}(o(),t,r)),this}}class u{constructor(r){this.getShader(r),this.initShaders()}getShader(r){var t=gl.createShader(gl.VERTEX_SHADER),i=e(915)(`./${r}.vert`).default;gl.shaderSource(t,i),gl.compileShader(t);var o=gl.createShader(gl.FRAGMENT_SHADER);return i=e(312)(`./${r}.frag`).default,gl.shaderSource(o,i),gl.compileShader(o),gl.getShaderParameter(t,gl.COMPILE_STATUS)?gl.getShaderParameter(o,gl.COMPILE_STATUS)?(this.shaderProgram=gl.createProgram(),gl.attachShader(this.shaderProgram,t),gl.attachShader(this.shaderProgram,o),gl.linkProgram(this.shaderProgram),void(gl.getProgramParameter(this.shaderProgram,gl.LINK_STATUS)||alert("Could not initialise shaders"))):(alert(gl.getShaderInfoLog(o)),null):(alert(gl.getShaderInfoLog(t)),null)}initShaders(){gl.useProgram(this.shaderProgram),this.vertexPositionAttribute=gl.getAttribLocation(this.shaderProgram,"aVertexPosition"),gl.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexFrontColorAttribute=gl.getAttribLocation(this.shaderProgram,"aFrontColor"),gl.enableVertexAttribArray(this.vertexFrontColorAttribute),this.vertexNormalAttribute=gl.getAttribLocation(this.shaderProgram,"aNormal"),gl.enableVertexAttribArray(this.vertexNormalAttribute),this.pMatrixUniform=gl.getUniformLocation(this.shaderProgram,"uPMatrix"),this.mvMatrixUniform=gl.getUniformLocation(this.shaderProgram,"uMVMatrix"),this.invT_mvMatrixUniform=gl.getUniformLocation(this.shaderProgram,"uinvTMVMatrix"),this.modelMatrixUniform=gl.getUniformLocation(this.shaderProgram,"uModelMatrix"),this.invT_modelMatrixUniform=gl.getUniformLocation(this.shaderProgram,"uinvTModelMatrix")}setWorldMatrixUniforms(r){gl.useProgram(this.shaderProgram),gl.uniformMatrix4fv(this.pMatrixUniform,!1,r.pMatrix),gl.uniformMatrix4fv(this.mvMatrixUniform,!1,r.mvMatrix),gl.uniformMatrix4fv(this.invT_mvMatrixUniform,!1,r.invT_mvMatrix)}}class d{constructor(r){this.position=t(),this.rotation=o(),this.FOV=45,this.mvMatrix=a(),this.pMatrix=a(),this.invT_mvMatrix=a(),this.viewportWidth=r.width,this.viewportHeight=r.height}setMVP(){!function(r,t,e,i,o){var n,a=1/Math.tan(t/2);r[0]=a/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,n=1/-99.9,r[10]=100.1*n,r[14]=20*n}(this.pMatrix,this.FOV,this.viewportWidth/this.viewportHeight),g(this.mvMatrix,this.rotation),function(r,t,e){var i,o,n,a,s,l,g,h,v,u,d,c,f=e[0],m=e[1],x=e[2];t===r?(r[12]=t[0]*f+t[4]*m+t[8]*x+t[12],r[13]=t[1]*f+t[5]*m+t[9]*x+t[13],r[14]=t[2]*f+t[6]*m+t[10]*x+t[14],r[15]=t[3]*f+t[7]*m+t[11]*x+t[15]):(i=t[0],o=t[1],n=t[2],a=t[3],s=t[4],l=t[5],g=t[6],h=t[7],v=t[8],u=t[9],d=t[10],c=t[11],r[0]=i,r[1]=o,r[2]=n,r[3]=a,r[4]=s,r[5]=l,r[6]=g,r[7]=h,r[8]=v,r[9]=u,r[10]=d,r[11]=c,r[12]=i*f+s*m+v*x+t[12],r[13]=o*f+l*m+u*x+t[13],r[14]=n*f+g*m+d*x+t[14],r[15]=a*f+h*m+c*x+t[15])}(this.mvMatrix,this.mvMatrix,this.position),l(this.invT_mvMatrix,this.mvMatrix),s(this.invT_mvMatrix,this.invT_mvMatrix)}getMVP(){return{pMatrix:this.pMatrix,mvMatrix:this.mvMatrix,invT_mvMatrix:this.invT_mvMatrix}}}window.onload=()=>{return(r=document.createElement("canvas")).id="ICG-canvas",r.style.backgroundColor="#0078D4",r.width=1280,r.height=720,(c=new d({width:r.width,height:r.height})).position=i(0,0,-35),e.g.elapsed_time=.1,function(r){try{if(e.g.gl=r.getContext("webgl")||r.getContext("experimental-webgl"),!gl.getExtension("OES_standard_derivatives"))throw"OES std extension not supported!"}catch(r){}gl||alert("Could not initialise WebGL, sorry :-(")}(r),M.phong=new u("v"),M.goraud=new u("goraud"),M.flat=new u("flat"),x.easter=new v(M.phong,"Easter").setScale(10).setRot(-90,0,0).setPos(-15,0,0),x.teapot=new v(M.flat,"Teapot").setScale(.5),x.csie=new v(M.goraud,"Kangaroo").setScale(30).setRot(-45,0,0).setPos(20,0,0),gl.clearColor(.5,.5,.5,1),gl.enable(gl.DEPTH_TEST),document.body.appendChild(r),void p();var r};var c,f=20,m=0,x={},M={};function p(){var r;window.requestAnimFrame(p),f+=.05*elapsed_time,x.teapot.setRot(0,f,0),function(){gl.viewport(0,0,c.viewportWidth,c.viewportHeight),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),c.setMVP();let r=c.getMVP();Object.entries(M).forEach((([,t])=>t.setWorldMatrixUniforms(r))),Object.entries(x).forEach((([,r])=>r.draw()))}(),r=(new Date).getTime(),0!=m&&(elapsed_time=r-m),m=r}})()})();